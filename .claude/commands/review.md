Review this code for:
- Security issues (injection, auth, secrets, input validation)
- Performance problems (N+1 queries, unnecessary allocations, blocking calls)
- Language idioms (Go: error handling, naming; TS: types, async patterns)
- Edge cases and error paths
- Test coverage gaps

Be specific about line numbers and suggest fixes.
