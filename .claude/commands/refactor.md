Refactor this code to improve:
- Readability (clearer names, smaller functions, better structure)
- Maintainability (reduce coupling, improve cohesion)
- Testability (dependency injection, pure functions)

Preserve existing behavior. Explain each change.
